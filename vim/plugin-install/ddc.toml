# ddc.vim
[[plugins]]
repo = 'Shougo/ddc.vim'
hook_add = '''
set completeopt=menuone
'''
hook_post_source = '''
call ddc#custom#alias('source', 'coc-lsp', 'coc-patched')
call ddc#custom#alias('source', 'win32yank.exe', 'run')
let g:ddc_sources = [
      \ 'treesitter',
      \ 'coc-lsp',
      \ 'tabnine',
      \ 'tmux',
      \ 'around',
      \ 'buffer',
      \ 'file',
      \ 'neosnippet',
      \ 'win32yank.exe',
      \ 'registers-words',
      \ 'nextword',
    \ ]
if !executable('win32yank.exe')
  call filter(g:ddc_sources, 'v:val isnot# "win32yank.exe"')
endif
if !has('nvim')
  call filter(g:ddc_sources, 'v:val isnot# "treesitter"')
endif
if g:lsp_mode isnot# 'coc'
  call filter(g:ddc_sources, 'v:val !~# "coc-.*"')
endif

call ddc#custom#patch_global('sources', g:ddc_sources)

call ddc#custom#patch_global('sourceOptions', {
    \ '_': {
    \   'matchers': ['matcher_fuzzy'],
    \   'sorters': ['sorter_rank'],
    \   'ignoreCase': v:true,
    \ }})

call ddc#custom#patch_global('sourceOptions', {
    \ 'a1': {
    \   'mark': 'A1',
    \   'dup': v:true,
    \ }})
call ddc#custom#patch_global('sourceOptions', {
    \ 'a2': {
    \   'mark': 'A2',
    \   'dup': v:true,
    \ }})

call ddc#custom#patch_global('sourceOptions', {
    \ 'around': {
    \   'mark': 'A',
    \   'minAutoCompleteLength': 4,
    \   'maxCandidates': 5,
    \ }})
call ddc#custom#patch_global('sourceParams', {
    \ 'around': {
    \   'maxSize': 500,
    \ }})

call ddc#custom#patch_global('sourceOptions', {
    \ 'win32yank.exe': {
    \   'mark': 'CLIP',
    \   'maxCandidates': 20,
    \ }})
call ddc#custom#patch_global('sourceParams', {
    \ 'win32yank.exe': {
    \   'cmd': ['win32yank.exe', '-o'],
    \ }})

call ddc#custom#patch_global('sourceOptions', {
    \ 'registers-words': {
    \   'mark': 'R',
    \   'maxCandidates': 20,
    \ }})
call ddc#custom#patch_global('sourceParams', {
    \ 'registers-words': {
    \   'registers': '/"0123',
    \ }})

call ddc#custom#patch_global('sourceOptions', {
    \ 'buffer': {
    \   'mark': 'B',
    \   'minAutoCompleteLength': 4,
    \   'maxCandidates': 5,
    \ }})
call ddc#custom#patch_global('sourceParams', {
    \ 'buffer': {
    \   'requireSameFiletype': v:false,
    \ }})

call ddc#custom#patch_global('sourceOptions', {
    \ 'nextword': {
    \   'mark': 'NEXT',
    \   'maxCandidates': 4,
    \   'isVolatile': v:true,
    \   'minAutoCompleteLength': 3,
    \ }})

call ddc#custom#patch_global('sourceOptions', {
    \ 'neosnippet': {
    \   'mark': 'SNIP',
    \   'minAutoCompleteLength': 2,
    \ }})

call ddc#custom#patch_global('sourceOptions', {
    \ 'tabnine': {
    \   'mark': 'TN',
    \   'maxCandidates': 5,
    \   'isVolatile': v:true,
    \   'minAutoCompleteLength': 2,
    \   'forceCompletionPattern': '.[^(]',
    \ }})

call ddc#custom#patch_global('sourceOptions', {
    \ 'tmux': {
    \   'mark': 'TMUX',
    \   'maxCandidates': 5,
    \ }})

call ddc#custom#patch_global('sourceOptions', {
    \ 'coc-lsp': {
    \   'mark': '',
    \   'isVolatile': v:true,
    \   'maxCandidates': 30,
    \   'forceCompletionPattern': '\.',
    \   'minAutoCompleteLength': 1,
    \ }})
call ddc#custom#patch_global('sourceParams', {
    \ 'coc-lsp': {
    \   'include': v:null,
    \   'exclude': ['F', 'A', 'B', 'TN'],
    \ }})
call ddc#custom#patch_filetype(
    \ ['json'], {
    \ 'sourceOptions': {
    \   'coc-lsp': {
    \     'matchers': [],
    \   },
    \ },
    \ 'sourceParams': {
    \   'coc-lsp': {
    \   },
    \ }})

call ddc#custom#patch_global('sourceOptions', {
    \ 'file-cwd': {
    \   'mark': 'CWD',
    \   'isVolatile': v:true,
    \   'forceCompletionPattern': '\S/\S*',
    \ }})
call ddc#custom#patch_global('sourceParams', {
    \ 'file-cwd': {
    \   'cwdMaxCandidates': 100,
    \   'bufMaxCandidates': 0,
    \   'projFromCwdMaxCandidates': [0],
    \   'projFromBufMaxCandidates': [0],
    \ }})
call ddc#custom#patch_global('sourceOptions', {
    \ 'file-buf': {
    \   'mark': 'BUF',
    \   'isVolatile': v:true,
    \   'forceCompletionPattern': '\S/\S*',
    \ }})
call ddc#custom#patch_global('sourceParams', {
    \ 'file-buf': {
    \   'cwdMaxCandidates': 0,
    \   'bufMaxCandidates': 100,
    \   'projFromCwdMaxCandidates': [0],
    \   'projFromBufMaxCandidates': [0],
    \ }})

call ddc#custom#patch_global('sourceOptions', {
    \ 'file': {
    \   'mark': 'F',
    \   'isVolatile': v:true,
    \   'forceCompletionPattern': '\S/\S*',
    \ }})
call ddc#custom#patch_filetype(
    \ ['ps1', 'dosbatch', 'autohotkey', 'registry'], {
    \ 'sourceOptions': {
    \   'file': {
    \     'forceCompletionPattern': '\S\\\S*',
    \   },
    \ },
    \ 'sourceParams': {
    \   'file': {
    \     'mode': 'win32',
    \   },
    \ }})

call ddc#custom#patch_global('sourceOptions', {
    \ 'treesitter': {
    \   'mark': 'TS',
    \ }})

inoremap <silent><expr> <TAB>
    \ pumvisible() ? '<C-n>' :
    \ (col('.') <= 1 <Bar><Bar> getline('.')[col('.') - 2] =~# '\s') ?
    \ '<TAB>' : ddc#manual_complete()
inoremap <silent><expr> <C-n> ddc#manual_complete()

inoremap <expr><S-TAB> pumvisible() ? '<C-p>' : '<C-h>'

" call timer_start(1000, {->execute('call ddc#enable()')})
call ddc#enable()

" Debug
" call ddc#custom#patch_global('sources', ['around'])
" call ddc#custom#patch_global('sources', ['file'])
" call ddc#custom#patch_global('sources', ['coc-lsp'])
" call ddc#custom#patch_global('sources', ['registers-words'])
" call ddc#custom#patch_global('sources', ['tabnine'])
" call ddc#custom#patch_global('sources', ['win32yank.exe'])
'''

[[plugins]]
repo = 'Shougo/ddc-around'
depends = ['ddc.vim']

[[plugins]]
repo = 'Shougo/ddc-sorter_rank'
depends = ['ddc.vim']

[[plugins]]
repo = 'Shougo/ddc-matcher_head'
depends = ['ddc.vim']

[[plugins]]
repo = 'matsui54/ddc-matcher_fuzzy'
depends = ['ddc.vim']

[[plugins]]
repo = 'Shougo/ddc-nextword'
depends = ['ddc.vim']

[[plugins]]
repo = 'delphinus/ddc-treesitter'
if = 'has("nvim")'
depends = ['ddc.vim', 'nvim-treesitter']

[[plugins]]
repo = 'LumaKernel/ddc-file'
depends = ['ddc.vim']
# repo = '~/ghq/github.com/LumaKernel/ddc-file'
# merged = 0

[[plugins]]
repo = 'matsui54/ddc-buffer'
depends = ['ddc.vim']

[[plugins]]
repo = 'LumaKernel/ddc-tabnine'
if = '!IsPrivateMode()'
depends = ['ddc.vim']
hook_add = '''
command! -bar EditTabNineConfig execute 'edit' ddc_tabnine#config_dir() . '/tabnine_config.json'
'''
# repo = '~/ghq/github.com/LumaKernel/ddc-tabnine'
# merged = 0
# hook_add = '''
# " let g:ddc_tabnine#storage_dir = expand('~/xxx-my-tabnine/binaries')
# " let g:ddc_tabnine#disable_auto_install = v:true
# '''

[[plugins]]
repo = 'delphinus/ddc-tmux'
depends = ['ddc.vim']

[[plugins]]
repo = 'LumaKernel/ddc-registers-words'
depends = ['ddc.vim']
# repo = '~/ghq/github.com/LumaKernel/ddc-registers-words'
# merged = 0

[[plugins]]
repo = 'LumaKernel/ddc-run'
depends = ['ddc.vim']
# repo = '~/ghq/github.com/LumaKernel/ddc-run'
# merged = 0

[[plugins]]
repo = '~/ghq/github.com/LumaKernel/ddc-coc-patched'
merged = 0
# rev = 'v0.0.0-2021-09-17-1'
depends = ['ddc.vim', 'coc-patched.nvim']
